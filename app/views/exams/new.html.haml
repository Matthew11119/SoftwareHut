%h2 New exams

.modal-dialog
  .modal-content
    .modal-header
      %button.close{ type: :button, data: { dismiss: :modal } }
        %span &times;


    = simple_form_for(@exam) do |f|
      .modal-header
        %h2.modal-title New exam from blank
        = f.error_notification
        = f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present?

      .modal-body
        %h3 Exam
        %h6 Name
        = f.input :name, input_html: {placeholder: "Name"}
        %h6 Exam Code
        = f.input :exam_code
        %h6 Date
        = f.input :date
        %h6 Module Code
        = f.input :module_code

        .form-section
          %h3
            Stations
            = link_to 'New Station', station_path(@exam.exam_code), class: 'btn btn-default', method: :post

          -Station.where(exam_id: @exam.exam_code).each do |station|
            .form-section
              %h4
                = station[:station_name]
                = link_to 'Edit', edit_station_path(station), class: 'btn btn-default'
                = link_to 'Delete', station_path(station['id']), method: :delete, data: { confirm: 'Are you sure?' }, class: 'btn btn-default'

              %table.table.thead-dark.table-bordered
                %thead
                  %tr
                    %th Criteria
                    - answers = Answer.where(station_id: station.id).order(:score)
                    - answers.each do |answer|
                      %th= answer[:text]

                %tbody
                  - Criterium.where(station_id: station.id).order(:number).each do |criterium|
                    %tr
                      %td= criterium[:criteria_description]
                      -answers.each do |a|
                        %td
          %br


      .modal-footer
        .pull-left
          = dismiss_modal_button
        = f.button :submit, 'Save'

= link_to 'Back', exams_path
